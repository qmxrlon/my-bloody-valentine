<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Valentinstag ğŸ’˜</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: radial-gradient(circle, #ffe0f0, #ffb6d5);
  text-align: center;
  padding: 20px;
  overflow-x: hidden;
}

.card {
  background: white;
  border-radius: 22px;
  padding: 25px;
  max-width: 420px;
  width: 95%;
  margin: auto;
  box-shadow: 0 0 20px rgba(0,0,0,0.25);
}

h1 { color:#e60073; font-size:1.6rem; }

input {
  padding:12px;
  width:90%;
  border-radius:12px;
  border:1px solid #ccc;
  font-size:16px;
}

button {
  padding:12px 22px;
  font-size:17px;
  border-radius:14px;
  margin:8px;
  cursor:pointer;
}

.yes { background:#ff4da6; color:white; }
.no { background:lightgray; position:relative; }

#enableSoundBtn {
  background:#ff9ad5;
  border:none;
}

#screenshotBtn, #shareBtn { display:none; background:#ff7abf; }

.cats img {
  width:110px;
  margin:6px;
  border-radius:14px;
}

#happyCat { display:none; width:200px; margin-top:15px; }

#contract {
  display:none;
  margin-top:15px;
  background:#fff0f6;
  padding:15px;
  border-radius:15px;
  border:2px dashed #ff4da6;
}

/* Falling hearts */
.heartRain {
  position:fixed;
  top:-20px;
  width:18px;
  height:18px;
  background:#ff4da6;
  transform:rotate(45deg);
  animation:fall linear forwards;
  z-index:1;
}

.heartRain::before,
.heartRain::after {
  content:"";
  width:18px;
  height:18px;
  background:#ff4da6;
  position:absolute;
  border-radius:50%;
}
.heartRain::before { top:-9px; left:0; }
.heartRain::after { left:-9px; top:0; }

@keyframes fall {
  to { transform:translateY(110vh) rotate(45deg); opacity:0; }
}

body.loveMode { animation:glow 2s infinite alternate; }

@keyframes glow {
  from { background:#ffd6eb; }
  to { background:#ffb6d5; }
}

/* speech bubble */
#catSpeech {
  display:none;
  background:white;
  padding:8px 14px;
  border-radius:15px;
  margin-top:8px;
}
</style>
</head>

<body>

<div class="card">

<button id="enableSoundBtn">ğŸ”Š Sound aktivieren</button>

<h1>ğŸ’– MÃ¶chtest du mein Valentinstag Date sein? ğŸ’–</h1>

<input id="nameInput" placeholder="Dein Name..." />

<div>
  <button class="yes" onclick="sayYes()">Ja ğŸ’•</button>
  <button class="no" id="noBtn">Nein (nuh uh) ğŸ˜</button>
</div>

<div id="result"></div>

<div id="contract"></div>

<button id="screenshotBtn" onclick="takeShot()">ğŸ“¸ Screenshot</button>
<button id="shareBtn" onclick="sharePage()">ğŸ“¤ Teilen</button>

<img id="happyCat" src="https://media.giphy.com/media/mlvseq9yvZhba/giphy.gif">
<div id="catSpeech">Miau ğŸ˜» beste Entscheidung!</div>

<div class="cats">
  <img src="https://media.giphy.com/media/JIX9t2j0ZTN9S/giphy.gif">
  <img src="https://media.giphy.com/media/MDJ9IbxxvDUQM/giphy.gif">
  <img src="https://media.giphy.com/media/3oriO0OEd9QIDdllqo/giphy.gif">
</div>

</div>

<audio id="music" preload="auto" loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/10/03/audio_4c8c9c1e91.mp3">
</audio>

<audio id="fireSound" preload="auto">
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_52a5f8bda7.mp3">
</audio>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<script>
const noBtn=document.getElementById("noBtn");
const music=document.getElementById("music");
const fireSound=document.getElementById("fireSound");
const enableBtn=document.getElementById("enableSoundBtn");

let soundEnabled=false;

enableBtn.onclick=()=>{
  music.play().then(()=>{
    music.pause();
    music.currentTime=0;
    soundEnabled=true;
    enableBtn.innerText="ğŸ”Š Sound aktiviert ğŸ’•";
  });
};

noBtn.addEventListener("mouseover",jumpNo);
noBtn.addEventListener("touchstart",jumpNo);

function jumpNo(){
  const x=Math.random()*200-100;
  const y=Math.random()*200-100;
  noBtn.style.transform=`translate(${x}px,${y}px)`;
}

function sayYes(){
  const name=new URLSearchParams(window.location.search).get("name") ||
        document.getElementById("nameInput").value || "Du";

  document.body.classList.add("loveMode");

  if(soundEnabled){
    music.play();
    fireSound.play();
  }

  navigator.vibrate?.(300);

  document.getElementById("result").innerHTML=
   `<h2>ğŸ’˜ DankeschÃ¶n ${name}!</h2>
    <p>Ich freue mich riesig ğŸ¥° und ich liebe dich Ã¼ber alles mwuah ğŸ’–ğŸ±</p>`;

  document.getElementById("happyCat").style.display="block";
  document.getElementById("catSpeech").style.display="block";

  document.getElementById("contract").style.display="block";
  document.getElementById("contract").innerHTML=
   `<h3>ğŸ“œ Valentinstags-Vertrag</h3>
    <p>${name} & â¤ï¸ DU</p>
    <p>Datum: ${new Date().toLocaleDateString()}</p>`;

  document.getElementById("screenshotBtn").style.display="inline-block";
  document.getElementById("shareBtn").style.display="inline-block";

  burstHearts();
  startHeartRain();
  fireworks();
}

function burstHearts(){
  for(let i=0;i<25;i++){
    const h=document.createElement("div");
    h.className="heartRain";
    h.style.left="50vw";
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),3000);
  }
}

function startHeartRain(){
  setInterval(()=>{
    const h=document.createElement("div");
    h.className="heartRain";
    h.style.left=Math.random()*100+"vw";
    h.style.animationDuration=(Math.random()*2+3)+"s";
    document.body.appendChild(h);
    setTimeout(()=>h.remove(),5000);
  },400);
}

function fireworks(){
  for(let i=0;i<18;i++){
    const f=document.createElement("div");
    f.style.position="fixed";
    f.style.left="50vw";
    f.style.top="40vh";
    f.style.width="6px";
    f.style.height="6px";
    f.style.background="gold";
    f.style.borderRadius="50%";
    f.style.transform=`translate(${Math.random()*300-150}px,${Math.random()*300-150}px)`;
    document.body.appendChild(f);
    setTimeout(()=>f.remove(),1000);
  }
}

function takeShot(){
  html2canvas(document.body).then(canvas=>{
    const a=document.createElement("a");
    a.href=canvas.toDataURL();
    a.download="valentine.png";
    a.click();
  });
}

function sharePage(){
  if(navigator.share){
    navigator.share({
      title:"Valentinstag ğŸ’˜",
      url:window.location.href
    });
  }
}
</script>

<script>
const params=new URLSearchParams(window.location.search);
if(params.get("name")){
  document.getElementById("nameInput").value=params.get("name");
}
</script>

</body>
</html>
